import{o as F,r as o,a as R,b as L,j as s,C as q,c as $,L as w,d as z,e as I,f as Y,A as x,k as p,g as B,B as d,h as T,i as D,s as M}from"./index-p34BVjv6.js";import{F as O,c as Z,f as h,E as f,d as j,e as H}from"./index.esm-DArLBWuV.js";import{F as V}from"./Form-DBm2B7tt.js";import{L as P}from"./label-DPBphUux.js";import{I as N}from"./input-D2tw3W5N.js";import{A as G}from"./AuthLayout-93eNJb2q.js";import{A as J}from"./arrow-left-IJ8pBNrm.js";import{C as K}from"./check-D6M7RNXc.js";import{E as v}from"./eye-off-C7bVvEyj.js";import{E as g}from"./eye-C_wxQzYL.js";import"./en-US-2wKFi4xW.js";import"./endOfMonth-Cvw2Tj17.js";import"./format-BrDpOTCP.js";const Q=Z({newPassword:j().min(8,"Password must be at least 8 characters").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,"Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character").required("Password is required"),confirmPassword:j().oneOf([H("newPassword")],"Passwords must match").required("Confirm password is required")}),ds=()=>{const{token:r}=F(),[l,c]=o.useState(null),[y,b]=o.useState(!1),[n,C]=o.useState(!1),[i,E]=o.useState(!1),k=R(),{toast:m}=L();o.useEffect(()=>{r||c("Invalid reset link. Please request a new password reset link.")},[r]);const A={newPassword:"",confirmPassword:""},S=async(e,{setSubmitting:a})=>{if(c(null),!r){c("Invalid reset link. Please request a new password reset link."),a(!1);return}try{await M.resetPassword(r,e.newPassword),b(!0),m({title:"Success!",description:"Your password has been reset successfully. You can now log in with your new password.",variant:"default"}),setTimeout(()=>{k("/login")},3e3)}catch(t){const u=t instanceof Error?t.message:"An error occurred";c(u),m({title:"Error",description:u,variant:"destructive"})}finally{a(!1)}};return s.jsx(G,{title:"Reset Your Password",subtitle:"Create a new secure password for your account",children:s.jsxs(q,{className:"w-full max-w-md",children:[s.jsxs($,{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(w,{to:"/login",className:"text-muted-foreground hover:text-primary mr-2",children:s.jsx(J,{className:"h-4 w-4"})}),s.jsx(z,{className:"text-2xl font-bold",children:"Reset Password"})]}),s.jsx(I,{children:"Create a new password for your account"})]}),s.jsx(Y,{className:"space-y-4",children:y?s.jsx(x,{className:"bg-green-50 border-green-200",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(K,{className:"h-4 w-4 text-green-600 mr-2"}),s.jsx(p,{className:"text-green-800",children:"Your password has been reset successfully. Redirecting to login page..."})]})}):s.jsx(O,{initialValues:A,validationSchema:Q,onSubmit:S,children:({isSubmitting:e,touched:a,errors:t})=>s.jsxs(V,{className:"space-y-4",children:[l&&s.jsxs(x,{className:"bg-destructive/15 border-destructive/30",children:[s.jsx(B,{className:"h-4 w-4 text-destructive mr-2"}),s.jsx(p,{className:"text-destructive",children:l})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(P,{htmlFor:"newPassword",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(h,{as:N,id:"newPassword",name:"newPassword",type:n?"text":"password",placeholder:"••••••••",className:a.newPassword&&t.newPassword?"border-destructive pr-10":"pr-10",disabled:e}),s.jsx(d,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 text-muted-foreground",onClick:()=>C(!n),children:n?s.jsx(v,{className:"h-4 w-4"}):s.jsx(g,{className:"h-4 w-4"})})]}),s.jsx(f,{name:"newPassword",component:"div",className:"text-sm text-destructive"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Password must be at least 8 characters and include uppercase, lowercase, number, and special character."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(P,{htmlFor:"confirmPassword",children:"Confirm Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(h,{as:N,id:"confirmPassword",name:"confirmPassword",type:i?"text":"password",placeholder:"••••••••",className:a.confirmPassword&&t.confirmPassword?"border-destructive pr-10":"pr-10",disabled:e}),s.jsx(d,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 text-muted-foreground",onClick:()=>E(!i),children:i?s.jsx(v,{className:"h-4 w-4"}):s.jsx(g,{className:"h-4 w-4"})})]}),s.jsx(f,{name:"confirmPassword",component:"div",className:"text-sm text-destructive"})]}),s.jsx(d,{type:"submit",className:"w-full",disabled:e||!r,children:e?s.jsxs("span",{className:"flex items-center justify-center",children:[s.jsx(T,{size:"sm",className:"mr-2"})," Resetting..."]}):"Reset Password"})]})})}),s.jsx(D,{className:"flex justify-center border-t p-4",children:s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Remember your password?"," ",s.jsx(w,{to:"/login",className:"font-medium text-primary hover:underline",children:"Back to login"})]})})]})})};export{ds as default};
