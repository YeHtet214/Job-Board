import{u as k,r as o,o as V,a as C,p as E,j as e,g as R,B as n,q as x}from"./index-p34BVjv6.js";import{C as P}from"./check-D6M7RNXc.js";import{M as S}from"./mail-BIcE5EKX.js";const B=()=>{var j,p;const{verifyEmail:v,resendVerification:b}=k(),[y,i]=o.useState("loading"),[d,a]=o.useState(""),[c,f]=o.useState(!1),{token:t}=V(),m=C(),u=E(),l=((j=u.state)==null?void 0:j.email)||"",g=((p=u.state)==null?void 0:p.message)||"";o.useEffect(()=>{const s=sessionStorage.getItem(`verification_${t}`);t?s==="success"?(i("success"),a("Your email has already been verified. You can now log in to your account.")):N(t):l?(i("pending"),a(g||`We've sent a verification link to ${l}. Please check your inbox and spam folder.`)):(i("error"),a("Verification information is missing. Please check your email link or try registering again."))},[t,l,g]);const N=async s=>{try{const r=await v(s);i("success"),a((r==null?void 0:r.message)||"Your email has been successfully verified!"),sessionStorage.setItem(`verification_${t}`,"success")}catch(r){i("error"),a(r.message||"Failed to verify your email. Please try again."),sessionStorage.setItem(`verification_${t}`,"error")}},h=async()=>{if(!l){a("Email address is missing. Please try registering again.");return}f(!0);try{const s=await b(l);a((s==null?void 0:s.message)||"Verification email has been resent. Please check your inbox."),i("pending")}catch(s){a(s.message||"Failed to resend verification email. Please try again later.")}finally{f(!1)}},w=()=>{switch(y){case"loading":return e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(x,{className:"h-12 w-12 text-blue-600 animate-spin"}),e.jsx("p",{className:"text-jobboard-darkblue",children:"Verifying your email address..."})]});case"pending":return e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx("div",{className:"rounded-full bg-blue-100 p-3",children:e.jsx(S,{className:"h-12 w-12 sm:h-16 sm:w-16 text-blue-600"})}),e.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-blue-600",children:"Check Your Email"}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 text-blue-800 px-4 py-3 rounded-md w-full",children:d}),e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"The verification link is valid for 24 hours. If you don't see the email, check your spam folder."}),e.jsxs("div",{className:"flex flex-col sm:!flex-row gap-4 mt-2 w-full",children:[e.jsx(n,{onClick:()=>m("/login"),variant:"outline",className:"flex-6",children:"Back to Login"}),e.jsx(n,{onClick:h,disabled:c,className:"flex-6",children:c?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"mr-2 h-4 w-4 animate-spin"}),"Resending..."]}):"Resend Verification Email"})]})]});case"success":return e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx("div",{className:"rounded-full bg-green-100 p-3",children:e.jsx(P,{className:"h-12 w-12 sm:h-16 sm:w-16 text-green-600"})}),e.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-green-600",children:"Email Verified!"}),e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-md w-full",children:d}),e.jsx("div",{className:"flex gap-4 mt-2",children:e.jsx(n,{onClick:()=>m("/login"),className:"px-4 py-2",children:"Go to Login"})})]});case"error":return e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx("div",{className:"rounded-full bg-red-100 p-3",children:e.jsx(R,{className:"h-12 w-12 sm:h-16 sm:w-16 text-red-600"})}),e.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-red-600",children:"Verification Failed"}),e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-md w-full",children:d}),e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Your verification link may have expired. Verification links are valid for 24 hours."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mt-2 w-full",children:[e.jsx(n,{onClick:()=>m("/"),variant:"outline",className:"w-full",children:"Back to Home"}),l&&e.jsx(n,{onClick:h,className:"w-full",disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"mr-2 h-4 w-4 animate-spin"}),"Resending..."]}):"Resend Verification Email"})]})]});default:return null}};return e.jsx("div",{className:"flex justify-center items-center min-h-[80vh] px-4 py-8",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-8 max-w-md w-full",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-6 text-center",children:"Email Verification"}),w()]})})};export{B as default};
